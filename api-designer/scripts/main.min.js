!function(){"use strict";angular.module("ramlEditorApp",["ngResource","ngSanitize","ui.bootstrap.modal","ui.bootstrap.tpls","ramlConsoleApp","codeMirror","fs","helpers","raml","stringFilters","utils","lightweightDOM","splitter"]).run(["$window",function(a){a.RAML.Settings.proxy="/proxy/"}])}(),function(){"use strict";angular.module("utils",[]).value("indentUnit",2).factory("safeApply",["$rootScope","$exceptionHandler",function(a,b){return function(c,d){if(c=c||a,-1===["$apply","$digest"].indexOf(c.$root.$$phase))return c.$apply(d);try{return c.$eval(d)}catch(e){b(e)}}}]).factory("safeApplyWrapper",["safeApply",function(a){return function(b,c){return function(){var d=Array.prototype.slice.call(arguments,0);return a(b,function(){return c.apply(this,d)})}}}]).factory("getTime",function(){return Date.now||function(){return(new Date).getTime()}}).factory("debounce",["$timeout",function(a){return function(b,c,d){var e;return function(){e&&a.cancel(e),e=a(b,c,d)}}}]).factory("throttle",["getTime","$timeout",function(a,b){function c(c,d,e){var f,g,h,i=null,j=0;e||(e={});var k=function(){j=e.leading===!1?0:a(),i=null,h=c.apply(f,g)};return function(){var l=a();j||e.leading!==!1||(j=l);var m=d-(l-j);return f=this,g=arguments,0>=m?(b.cancel(i),i=null,j=l,h=c.apply(f,g)):i||e.trailing===!1||(i=b(k,m)),h}}return c}]).value("generateSpaces",function(a){return a=a||0,new Array(a+1).join(" ")}).factory("generateTabs",["generateSpaces","indentUnit",function(a,b){return function(c,d){return d=d||b,c=c||0,new Array(c+1).join(a(b))}}]).value("$prompt",function(a,b){return window.prompt(a,b)}).value("$confirm",function(a){return window.confirm(a)}).factory("scroll",function(){function a(a){a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1}function b(b){return d[b.keyCode]?void a(b):void 0}function c(b){a(b)}var d={37:!0,38:!0,39:!0,40:!0};return{enable:function(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",c,!1),window.onmousewheel=document.onmousewheel=document.onkeydown=null},disable:function(){window.addEventListener&&window.addEventListener("DOMMouseScroll",c,!1),window.onmousewheel=document.onmousewheel=c,document.onkeydown=b}}})}(),function(){"use strict";angular.module("raml").value("config",{set:function(a,b){localStorage["config."+a]=b},get:function(a,b){return a="config."+a,a in localStorage?localStorage[a]:b},remove:function(a){delete localStorage["config."+a]},clear:function(){localStorage.clear()}})}(),function(){"use strict";angular.module("lightweightDOM",["lightweightParse"]).factory("getNode",["getSpaceCount","getTabCount","getLineIndent","isArrayStarter","isCommentStarter","extractKeyValue",function(a,b,c,d,e,f){function g(a,b,f){this.editor=a,this.lineNumber=b,this.line=f,this.lineIndent=c(this.line,a.getOption("indentUnit")),this.isEmpty=this.lineIndent.spaceCount===this.line.length,this.isComment=!this.isEmpty&&e(this.line),this.isArrayStarter=!this.isComment&&d(this.line),this.isStructural=!this.isEmpty&&!this.isComment}function h(b,c){var d=b.getCursor(),e=arguments.length>1?c:d.line,f=b.getLine(e),h=i[e];if(void 0===f)return null;if(d.line===e){var j=a(f);(j===f.length||"#"===f[j])&&(f=f.slice(0,d.ch))}return h&&h.line===f||(h=i[e]=new g(b,e,f)),h}var i={};return g.prototype.getKeyValue=function(){return this.keyValue||(this.keyValue=f(this.line)),this.keyValue},g.prototype.getKey=function(){return this.getKeyValue().key},g.prototype.getValue=function(){return this.getKeyValue().value},g.prototype.getNextSibling=function(){for(var a=this.lineNumber;;){var b=h(this.editor,++a);if(null===b)return null;if(b.isStructural){if(b.lineIndent.tabCount===this.lineIndent.tabCount)return b;if(this.isArrayStarter&&!b.isArrayStarter&&b.lineIndent.tabCount===this.lineIndent.tabCount+1)return b;if(!this.isArrayStarter&&b.isArrayStarter&&b.lineIndent.tabCount===this.lineIndent.tabCount-1)return b;if(b.lineIndent.tabCount<this.lineIndent.tabCount)return null}}},g.prototype.getPreviousSibling=function(){for(var a=this.lineNumber;;){a-=1;var b=h(this.editor,a);if(null===b)return null;if(b.isStructural){if(b.lineIndent.tabCount===this.lineIndent.tabCount)return b;if(this.isArrayStarter&&!b.isArrayStarter&&b.lineIndent.tabCount===this.lineIndent.tabCount+1)return b;if(!this.isArrayStarter&&b.isArrayStarter&&b.lineIndent.tabCount===this.lineIndent.tabCount-1)return b;if(b.lineIndent.tabCount<this.lineIndent.tabCount)return null}}},g.prototype.getFirstChild=function(){for(var a=this.lineIndent.tabCount+(this.isArrayStarter?2:1),b=this.lineNumber;;){var c=h(this.editor,++b);if(null===c)return null;if(c.lineIndent.tabCount<a)return null;if(c.lineIndent.tabCount>=a&&c.isStructural)return c}},g.prototype.getParent=function(){for(var a=this.lineIndent.tabCount-(!this.isArrayStarter&&this.getIsInArray()?2:1),b=this.lineNumber;;){var c=h(this.editor,--b);if(null===c)return null;if(c.lineIndent.tabCount<=a&&c.isStructural)return c}},g.prototype.getChildren=function(){for(var a=[],b=this.getFirstChild();null!==b;)a.push(b),b=b.getNextSibling();return a},g.prototype.getSelfAndNeighbors=function(){for(var a=[],b=this.getIsInArray(),c=this;c&&c.getIsInArray()===b&&(a.push(c),!c.isArrayStarter);)c=c.getPreviousSibling();for(c=this.getNextSibling();c&&!c.isArrayStarter&&c.getIsInArray()===b;)a.push(c),c=c.getNextSibling();return a},g.prototype.getIsInArray=function(){if(this.isArrayStarter)return!0;for(var a=this.getPreviousSibling();a&&a.lineIndent.tabCount>=this.lineIndent.tabCount;)a=a.getPreviousSibling();return!(!a||!a.isArrayStarter||a.lineIndent.tabCount!==this.lineIndent.tabCount-1)},g.prototype.getPath=function(){for(var a=[],b=this;b=b.getParent();)a.unshift(b);return a},g.prototype.selfOrParent=function(a){return this.first(this.getParent,a)},g.prototype.selfOrPrevious=function(a){return this.first(this.getPreviousSibling,a)},g.prototype.first=function(a,b){for(var c=this;c;){if(b(c))return c;c=a.apply(c)}return null},h}])}(),function(){"use strict";angular.module("lightweightParse",["utils"]).factory("getEditorTextAsArrayOfLines",function(){var a="",b=[];return function(c){if(a===c.getValue())return b;a=c.getValue(),b=[];for(var d=0,e=c.lineCount();e>d;d++)b.push(c.getLine(d));return b}}).factory("getSpaceCount",function(){return function(a){for(var b=0,c=a.length;c>b&&" "===a[b];b++);return b}}).factory("getTabCount",["indentUnit",function(a){return function(b,c){return c=c||a,Math.floor(b/c)}}]).factory("getLineIndent",["getSpaceCount","getTabCount",function(a,b){return function(c,d){var e=a(c);return{spaceCount:e,tabCount:b(e,d),content:e?c.slice(e):c}}}]).factory("isArrayStarter",["getSpaceCount",function(a){return function(b){var c=a(b);return"-"===b[c]&&" "===b[c+1]}}]).factory("isCommentStarter",["getSpaceCount",function(a){return function(b){var c=a(b);return"#"===b[c]}}]).factory("extractKeyValue",function(){function a(a,b,c){for(b=b||0,c=c||a.length,0>b&&(b=a.length+b),0>c&&(c=a.length+c);c>b&&" "===a[b];)b+=1;for(;c>b&&" "===a[c-1];)c-=1;return 0===b&&c===a.length?a:a.slice(b,c)}function b(a){return a?{text:a,isAlias:"&"===a[0],isReference:"*"===a[0]}:null}return function(c){var d=0,e=c.length,f=c.indexOf("#");return-1!==f&&(e=f),f=c.indexOf("- "),-1!==f&&e>f&&(d=f+2),f=c.indexOf(": ",d),-1!==f&&e>f?{key:a(c,d,f),value:b(a(c,f+2,e))}:(f=c.lastIndexOf(":",e),f===e-1?{key:a(c,d,e-1),value:null}:{key:null,value:b(a(c,d,e))})}}).factory("getScopes",["getLineIndent",function(a){function b(a,b){if(void 0===a||void 0===b)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}var c;return function(d){if(c&&b(c.key,d))return c.value;var e={},f=d.map(function(b,c){var d=a(b);return{tabCount:d.tabCount,content:d.content,lineNumber:c}}),g=f.reduce(function(a,b){var c,d,f=e[b.tabCount-1];if(f)c=f.length-1,d=e[b.tabCount-1][c];else{if(b.tabCount>1)return f=e[b.tabCount-2],f&&(c=f.length-1,d=e[b.tabCount-2][c],a[d]=a[d]||[],a[d].push({lineNumber:b.lineNumber,content:b.content,tabCount:b.tabCount}),e[b.tabCount-1]=e[b.tabCount-1]||[],e[b.tabCount-1].push(b.lineNumber)),a;d=0}return a[d]=a[d]||[],a[d].push({lineNumber:b.lineNumber,content:b.content,tabCount:b.tabCount}),e[b.tabCount]=e[b.tabCount]||[],e[b.tabCount].push(b.lineNumber),a},{});return c={result:{scopeLevels:e,scopesByLine:g},lines:d},{scopeLevels:e,scopesByLine:g}}}])}(),function(){"use strict";angular.module("codeFolding",["raml","lightweightParse"]).factory("getFoldRange",["getLineIndent",function(a){return function(b,c){var d,e=b.getLine(c.line),f=a(e);if(f.content){var g=b.getLine(c.line+1);if(g){var h=f.tabCount,i=a(g).tabCount;if(i>h)for(var j=c.line+2,k=b.lineCount();k>j;j++){if(g=b.getLine(j),d=a(g),i=d.tabCount,h>=i&&d.content)return g=b.getLine(j-1),{from:CodeMirror.Pos(c.line,e.length),to:CodeMirror.Pos(j-1,g.length)};if(j===k-1)return g=b.getLine(k-1),{from:CodeMirror.Pos(c.line,e.length),to:CodeMirror.Pos(k-1,g.length)}}}}}}])}(),function(){"use strict";angular.module("codeMirror",["raml","ramlEditorApp","codeFolding"]).factory("codeMirror",["ramlHint","codeMirrorHighLight","eventService","generateSpaces","generateTabs","getFoldRange","isArrayStarter","getSpaceCount","getTabCount","config","extractKeyValue",function(a,b,c,d,e,f,g,h,i,j,k){var l=null,m={CodeMirror:CodeMirror};m.removeTabs=function(a,b){var c=i(h(a),b)*b;return c?a.slice(c):a},m.tabKey=function(a){var b,c,e,f=a.getCursor(),g=a.getLine(f.line),h=a.getOption("indentUnit");return a.somethingSelected()?void a.indentSelection("add"):(c=m.removeTabs(g,h),c=c.length?c:"",e=""!==c&&""===c.replace(/ /g,"")?h-c.length:h,b=d(e),void a.replaceSelection(b,"end","+input"))},m.backspaceKey=function(a){var b=a.getCursor(),c=a.getLine(b.line).slice(0,b.ch),d=a.getOption("indentUnit"),e=c.length-c.trimRight().length,f=e>=d;if(f&&e%d===0)for(var g=0;d>g;g++)a.deleteH(-1,"char");else a.deleteH(-1,"char")};var n={xml:{name:"xml"},xsd:{name:"xml",alignCDATA:!0},json:{name:"javascript",json:!0},md:{name:"gfm"},raml:{name:"raml"}},o={"Cmd-S":"save","Ctrl-S":"save","Shift-Tab":"indentLess","Shift-Ctrl-T":"toggleTheme"},p={"Ctrl-Space":"autocomplete","Cmd-S":"save","Ctrl-S":"save","Shift-Tab":"indentLess","Shift-Ctrl-T":"toggleTheme"},q=function(a){a.getLine(a.getCursor().line).trim()&&a.execCommand("autocomplete")};return m.configureEditor=function(a,b){var c=n[b]||n.raml;a.setOption("mode",c),"raml"===c.name?(a.setOption("extraKeys",p),a.on("change",q)):(a.setOption("extraKeys",o),a.off("change",q))},m.enterKey=function(a){function b(b,c){for(var d=b-1;d>=0;d--)if(h(a.getLine(d))<c)return k(a.getLine(d)).key}var c=a.getCursor(),f=c.ch>=a.getLine(c.line).length-1,i=a.getLine(c.line).slice(0,c.ch),j=g(i),l=h(i),m=d(l),n=b(c.line,l),o=-1!==["traits","resourceTypes"].indexOf(n);f?!function(){if(o)return void(m+=e(2));if(j&&(m+=e(1)),"|"===i.trimRight().slice(-1))return void(m+=e(1));var b=a.getLine(c.line+1);b&&h(b)>l&&(m+=e(1))}():j&&(m+=e(1)),a.replaceSelection("\n"+m,"end","+input")},m.createEditor=function(a,b){var c,d,e=JSON.parse(j.get("folding","true")),f=!1;e&&(f={rangeFinder:CodeMirror.fold.indent,foldOnChangeTimeSpan:300,updateViewportTimeSpan:200}),d={mode:"raml",theme:"solarized dark",lineNumbers:!0,lineWrapping:!0,autofocus:!0,indentWithTabs:!1,indentUnit:2,tabSize:2,keyMap:"tabSpace",foldGutter:f,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"]},b&&Object.keys(b).forEach(function(a){d[a]=b[a]}),c=new CodeMirror(a,d),c.setSize("100%","100%"),c.foldCode(0,{rangeFinder:CodeMirror.fold.indent});var g=c.defaultCharWidth(),h=4;return c.on("renderLine",function(a,b,c){var d=CodeMirror.countColumn(b.text,null,a.getOption("tabSize"))*g;c.style.textIndent="-"+d+"px",c.style.paddingLeft=h+d+"px"}),c},m.initEditor=function(){var a=document.getElementById("code"),b=m.createEditor(a);return l=window.editor=b,b},m.getEditor=function(){return l},function(){CodeMirror.keyMap.tabSpace={Tab:m.tabKey,Backspace:m.backspaceKey,Enter:m.enterKey,fallthrough:["default"]},CodeMirror.commands.save=function(){c.broadcast("event:save")},CodeMirror.commands.autocomplete=function(a){CodeMirror.showHint(a,CodeMirror.hint.raml,{ghosting:!0})},CodeMirror.commands.toggleTheme=function(){c.broadcast("event:toggle-theme")},CodeMirror.defineMode("raml",b.highlight),CodeMirror.defineMIME("text/x-raml","raml"),CodeMirror.registerHelper("hint","raml",a.autocompleteHelper),CodeMirror.registerHelper("fold","indent",f)}(),m}])}(),function(){"use strict";angular.module("codeMirror").factory("codeMirrorErrors",["codeMirror","$timeout",function(a,b){function c(a,b){function c(a){return d.parentNode?(d.style.top=Math.max(0,a.clientY-d.offsetHeight-5)+"px",void(d.style.left=a.clientX+5+"px")):l.off(document,"mousemove",c)}var d=document.createElement("div");return d.className="CodeMirror-lint-tooltip",d.appendChild(b.cloneNode(!0)),document.body.appendChild(d),l.on(document,"mousemove",c),c(a),null!==d.style.opacity&&(d.style.opacity=1),d}function d(a){a.parentNode&&a.parentNode.removeChild(a)}function e(a){a.parentNode&&(null===a.style.opacity&&d(a),a.style.opacity=0,b(function(){d(a)},200))}function f(a,b,d){function f(){l.off(d,"mouseout",f),g&&(e(g),g=null)}var g=c(a,b),h=setInterval(function(){if(!g)return clearInterval(h);for(var a=d;;a=a.parentNode){if(a===document.body)return;if(!a){f();break}}},400);l.on(d,"mouseout",f)}function g(a){a.clearGutter(m)}function h(a,b){return"error"===a?a:b}function i(a){for(var b=[],c=0;c<a.length;++c){var d=a[c],e=d.line;(b[e]||(b[e]=[])).push(d)}return b}function j(a){var b=a.severity;n.test(b)||(b="error");var c=document.createElement("div");return c.className="CodeMirror-lint-message-"+b,c.appendChild(document.createTextNode(a.message)),c}function k(a,b,c,d,e){var g=document.createElement("div"),h=g;return g.className="CodeMirror-lint-marker-"+b,c&&(h=g.appendChild(document.createElement("div")),h.className="CodeMirror-lint-marker-multiple"),d!==!1&&l.on(h,"mouseover",function(b){f(b,a,h)}),g.setAttribute("data-marker-line",e[0].line),g.setAttribute("data-marker-message",e[0].message),g}var l=a.CodeMirror,m="CodeMirror-lint-markers",n=/^(?:error|warning)$/,o={};return o.displayAnnotations=function(b){var c=a.getEditor(),d=i(b);this.clearAnnotations();for(var e=0;e<d.length;++e){var f=d[e];if(f){for(var g=null,l=document.createDocumentFragment(),o=0;o<f.length;++o){var p=f[o],q=p.severity;n.test(q)||(q="error"),g=h(g,q),l.appendChild(j(p))}c.setGutterMarker(e-1,m,k(l,g,f.length>1,!0,f))}}},o.clearAnnotations=function(){var b=a.getEditor();g(b)},o}])}(),function(){"use strict";var a;try{a=angular.module("helpers")}catch(b){a=angular.module("helpers",[])}a.factory("eventService",["$rootScope","$timeout",function(a,b){var c={},d={};return c.broadcast=function(b,c){a.$broadcast(b,c),d[b]={data:c}},c.on=function(c,e){a.$on(c,e),d[c]&&e&&b(function(){e({},d[c].data)})},c}])}(),function(){"use strict";angular.module("ramlEditorApp").factory("getNeighborLines",["getLineIndent","isArrayStarter",function(a,b){return function(c,d){"number"!=typeof d&&(d=c.getCursor().line);var e,f,g,h=[d],i=c.getLine(d).slice(0,c.getCursor().ch+1),j=a(i),k=b(i),l=c.lineCount();for(e=d-1;e>=0;e--)if(f=c.getLine(e),g=a(f),g.tabCount===j.tabCount){if(b(f))break;h.push(e)}else if(g.tabCount<j.tabCount){!k&&b(f)&&g.tabCount+1===j.tabCount&&h.push(e);break}for(e=d+1;l>e;e++){if(f=c.getLine(e),g=a(f),g.tabCount!==j.tabCount){if(g.tabCount<j.tabCount)break;if(!k||g.tabCount!==j.tabCount+1)continue}else if(b(f))break;h.push(e)}return h.sort().map(function(a){return c.getLine(a)})}}]).factory("getNeighborKeys",["getNeighborLines","extractKeyValue",function(a,b){return function(c){return a(c).map(function(a){return b(a).key})}}]).factory("ramlHint",["generateTabs","getNeighborKeys","getTabCount","getScopes","getEditorTextAsArrayOfLines","getNode",function(a,b,c,d,e,f){var g={},h="#%RAML 0.8",i=new RegExp("^\\s*"+h+"\\s*$","i");return g.suggestRAML=RAML.Grammar.suggestRAML,g.getScopes=function(a){return d(e(a))},g.shouldSuggestVersion=function(a){var b=a.getCursor().line,c=a.getLine(b),d=i.test(c);return 0===b&&!d},g.isSuggestionInUse=function(a,b,c){var d=c.map(b.metadata.isText?function(a){return a.getValue()?a.getValue().text:null}:function(a){return a.getKey()});return-1!==d.indexOf(a)||!b.metadata.isText&&b.metadata.canBeOptional&&-1!==d.indexOf(a+"?")},g.getSuggestions=function(a){if(g.shouldSuggestVersion(a))return[{key:"#%RAML 0.8",metadata:{category:"main",isText:!0}}];var b=f(a),d=b.selfOrParent(function(a){return a.getValue()&&a.getValue().isReference});if(d)return[];if(b.isEmpty){var e=a.getCursor().ch,h=c(e);if(h<=b.lineIndent.tabCount){var i=e%a.getOption("indentUnit")===0;if(!i)return[]}h=Math.min(h,b.lineIndent.tabCount),b=b.selfOrParent(function(a){return a.lineIndent.tabCount===h})}var j=null,k=[],l=[];if(b){var m=b.getPath().map(function(a){return a.getKey()});j=g.suggestRAML(m),k=j.suggestions;var n=Object.keys(k).some(function(a){return k[a].metadata.isText}),o=j.metadata&&j.metadata.isList&&n;l=o?b.getParent().getChildren():b.getSelfAndNeighbors(),l=l.filter(function(a){return a.isStructural})}return k=Object.keys(k).filter(function(a){return!g.isSuggestionInUse(a,k[a],l)}).sort().map(function(a){return{key:a,metadata:k[a].metadata}}),k.isList=j&&j.metadata?j.metadata.isList:!1,k},g.canAutocomplete=function(a){var b=a.getCursor(),c=a.getLine(b.line),d=c.trim(),e=c.indexOf(d),f=b.line;return function(){var a=d.indexOf("#");return f>0&&-1!==a&&b.ch>a+e}()?!1:function(){var a=d.indexOf("/");return 0===a&&b.ch>=a+e}()?!1:function(){var a=d.indexOf(": ");return-1!==a&&b.ch>=a+e+2}()?!1:function(){var a=d.indexOf("- ");return 0===a&&b.ch<a+e}()?!1:!0},g.autocompleteHelper=function(a){function b(a){return!a.metadata.dynamic}var c,d,e,f,h,i=a.getCursor(),j=a.getLine(i.line),k=j.trimLeft(),l=function(a,b,c){a.innerHTML=["<div>",c.displayText,"</div>",'<div class="category">',c.category,"</div>"].join("")};return g.canAutocomplete(a)?(d=g.getSuggestions(a),function(){var a=k.indexOf("#");-1!==a&&(0!==i.line||0!==a)&&(k=k.slice(0,a))}(),0===k.indexOf("- ")&&(k=k.slice(2)),function(){var a=k.match(/:(?:\s|$)/);a&&(k=k.slice(0,a.index),c=!0)}(),k=k.trim(),e=d.filter(b).map(function(a){var b=a.key;return a.metadata.isText||c||(b+=":"),{displayText:b,text:b,category:a.metadata.category,render:l}}),k&&(e=e.filter(function(a){return 0===a.text.indexOf(k)&&a.text.length!==k.length})),k?(f=j.indexOf(k),h=f+k.length):(f=i.ch,h=f),{word:k,list:e,from:CodeMirror.Pos(i.line,f),to:CodeMirror.Pos(i.line,h)}):void 0},g}])}(),function(){"use strict";angular.module("raml").value("snippets",{options:["options:","  description: <<insert text or markdown here>>"],head:["head:","  description: <<insert text or markdown here>>"],get:["get:","  description: <<insert text or markdown here>>"],post:["post:","  description: <<insert text or markdown here>>"],put:["put:","  description: <<insert text or markdown here>>"],"delete":["delete:","  description: <<insert text or markdown here>>"],trace:["trace:","  description: <<insert text or markdown here>>"],connect:["connect:","  description: <<insert text or markdown here>>"],patch:["patch:","  description: <<insert text or markdown here>>"],"<resource>":["/newResource:","  displayName: resourceName"],title:["title: My API"],version:["version: v0.1"],baseuri:["baseUri: http://server/api/{version}"]}).factory("ramlSnippets",["snippets",function(a){var b={};return b.getEmptyRaml=function(){return["#%RAML 0.8","title:"].join("\n")},b.getSnippet=function(b){var c=b.key,d=b.metadata||{},e=a[c.toLowerCase()];return e?e:d.isText?b.isList?[c]:[c,""]:[c+":"]},b}])}(),function(){"use strict";angular.module("codeMirror").value("highlightRootElement",function(a,b,c,d,e,f){return e<=d[a+".level"]&&(d[a+".level"]=0,d[a+".inside"]=!1),a.indexOf(f)>=0?(d[a+".level"]=e,d[a+".inside"]=!0,b):d[a+".inside"]?c:!1}).value("booleanValues",["true","false"]).factory("keywordRegex",["booleanValues",function(a){return new RegExp("\\b(("+a.join(")|(")+"))$","i")}]).factory("token",["keywordRegex","highlightRootElement","getLineIndent","indentUnit",function(a,b,c,d){return function(e,f){var g=e.peek(),h=f.escaped;if(f.escaped=!1,"#"===g&&"#%RAML 0.8"===e.string.trim())return e.skipToEnd(),"raml-tag";if("#"===g&&(0===e.pos||/\s/.test(e.string.charAt(e.pos-1))))return e.skipToEnd(),"comment";if(f.literal&&e.indentation()>f.keyCol)return e.skipToEnd(),"none";if(f.literal&&(f.literal=!1),e.sol()){if(f.keyCol=0,f.pair=!1,f.pairStart=!1,e.match(/---/))return"def";if(e.match(/\.\.\./))return"def";if(e.match(/\s*-\s+/))return"meta"}if(!f.pair&&e.match(/^\s*([a-z0-9\?\/\{\}\._\-])+(?=\s*:)/i)){var i=e.string.replace(/^\s+|\s+$/g,"").split(":")[0],j="?"===i.slice(-1)?i.slice(0,-1):i,k=c(e.string).tabCount;if(f.pair=!0,f.keyCol=e.indentation(),e.string.match(/^\s*\- /i)&&(f.keyCol+=d),(k<=f.methodLevel||0===i.indexOf("/"))&&(f.methodLevel=0,f.insideMethod=!1),-1!==["options","get","head","post","put","delete","trace","connect","patch"].indexOf(j))return f.methodLevel=k,f.insideMethod=!0,"method-title";if(f.insideMethod)return"method-content";var l=b("traits","trait-title","trait-content",f,k,i)||b("resourceTypes","resource-type-title","resource-type-content",f,k,i)||b("schemas","schema-title","schema-content",f,k,i)||b("securitySchemes","security-scheme-title","security-scheme-content",f,k,i);return l?l:0===i.indexOf("/")?"resource":"key"}if(f.pair&&e.match(/^:\s*/))return f.pairStart=!0,"meta";if(e.match(/^(\{|\}|\[|\])/))return"{"===g?f.inlinePairs++:"}"===g?f.inlinePairs--:"["===g?f.inlineList++:f.inlineList--,"meta";if(f.inlineList>0&&!h&&","===g)return e.next(),"meta";if(f.inlinePairs>0&&!h&&","===g)return f.keyCol=0,f.pair=!1,f.pairStart=!1,e.next(),"meta";if(f.pairStart){if(e.match(/^\s*(\||\>)\s*/))return f.literal=!0,"meta";if(e.match(/^\s*(\&|\*)[a-z0-9\._\-]+\b/i))return"variable-2";if(0===f.inlinePairs&&e.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(f.inlinePairs>0&&e.match(/^\s*-?[0-9\.\,]+\s?(?=(,|\}))/))return"number";if(e.match(a))return"keyword"}return f.pairStart=!1,f.escaped="\\"===g,e.next(),null}}]).value("startState",function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}}).factory("yamlMode",["token","startState",function(a,b){return function(){return{token:a,startState:b}}}]).run(["codeMirror","yamlMode",function(a,b){var c=a.CodeMirror;c.defineMode("yaml",b),c.defineMIME("text/x-yaml","yaml")}])}(),function(){"use strict";angular.module("codeMirror").factory("codeMirrorHighLight",["indentUnit",function(a){var b={};return b.highlight=function(a){return b.indentationOverlay={token:function(a,b){if(void 0===b.cutoff||a.column()<=b.cutoff){if(a.match("  "))return"indent indent-col-"+a.column();if(a.match(" "))return"indent-incomplete"}a.skipToEnd()},startState:function(){return{}}},b.yaml=CodeMirror.overlayMode(CodeMirror.getMode(a,"yaml"),b.indentationOverlay),b.xml=CodeMirror.overlayMode(CodeMirror.getMode(a,"xml"),b.indentationOverlay),b.json=CodeMirror.overlayMode(CodeMirror.getMode(a,{name:"javascript",json:!0}),b.indentationOverlay),b.markdown=CodeMirror.overlayMode(CodeMirror.getMode(a,"gfm"),b.indentationOverlay),{startState:function(){return{token:b._yaml,localMode:null,localState:null,yamlState:b.yaml.startState()}},copyState:function(a){var c;return a.localState&&(c=CodeMirror.copyState(a.localMode,a.localState),c.parentIndentation||(c.parentIndentation=a.localState.parentIndentation)),{token:a.token,localMode:a.localMode,localState:c,yamlState:CodeMirror.copyState(b.yaml,a.yamlState)}},innerMode:function(a){return{state:a.localState||a.yamlState,mode:a.localMode||b.yaml}},token:function(a,b){return b.token(a,b)}}},b._yaml=function(a,c){return/(content|description):(\s?)\|/.test(a.string)&&b._setMode("markdown",a,c),/application\/json:/.test(a.string)&&b._setMode("json",a,c,2),/text\/xml:/.test(a.string)&&b._setMode("xml",a,c,2),b.yaml.token(a,c.yamlState)},b._xml=function(a,c){return b._applyMode("xml",a,c)},b._json=function(a,c){return b._applyMode("json",a,c)},b._markdown=function(a,c){return b._applyMode("markdown",a,c)},b._setMode=function(c,d,e,f){e.token=b["_"+c],e.localMode=b[c],e.localState=b[c].startState(),e.localState.parentIndentation=d.indentation()+(f||0),d.string.match(/^\s*\- /i)&&(e.localState.parentIndentation+=a),"markdown"===c&&(e.localState.base.parentIndentation=e.localState.parentIndentation)},b._applyMode=function(a,c,d){return/(schema|example):(\s?)\|/.test(c.string)?b._yaml(c,d):c.string.trim().length>0&&c.indentation()<=d.localState.parentIndentation?(d.token=b._yaml,d.localState=d.localMode=null,b._yaml(c,d)):(d.localState.overlay.cutoff=d.localState.parentIndentation,b[a].token(c,d.localState))},b}])}(),function(){"use strict";function a(a,b,c){c=c||{},this.type="file",this.path=a,this.name=a.slice(a.lastIndexOf("/")+1),this.name.lastIndexOf(".")>0&&(this.extension=this.name.slice(this.name.lastIndexOf(".")+1)),this.contents=b||"",this.persisted=c.persisted||!1,this.dirty=c.dirty||!this.persisted,this.root=c.root}angular.module("fs",["ngCookies","raml","utils"]).factory("ramlRepository",["$q","$rootScope","ramlSnippets","fileSystem",function(b,c,d,e){function f(a){return".meta"!==a.path.slice(-5)}function g(b,c,d){"/"!==b.slice(-1)&&(b+="/"),d=d||[];var e=b.substring(0,b.length-1);this.type="directory",this.path=b,this.name=e.slice(e.lastIndexOf("/")+1),this.meta=c;var h={folder:[],file:[]};d.forEach(function(a){h[a.type||"file"].push(a)}),this.files=h.file.filter(f).map(function(b){return new a(b.path,b.contents,{dirty:!1,persisted:!0,root:b.root})}),this.files.sort(function(a,b){return a.name.localeCompare(b.name)}),this.directories=h.folder.map(function(a){return new g(a.path,a.meta,a.children)})}function h(a){return function(b){throw a.error=b,b}}var i={},j="/";return g.prototype.createFile=function(a){var b=i.createFile(a);return this.files.push(b),b},g.prototype.removeFile=function(a){var b=this;return i.removeFile(a).then(function(){var c=b.files.indexOf(a);-1!==c&&b.files.splice(c,1)})},i.getDirectory=function(a){return a=a||j,e.directory(a).then(function(a){return new g(a.path,a.meta,a.children)})},i.saveFile=function(a){function b(){return a.dirty=!1,a.persisted=!0,a}return e.save(a.path,a.contents).then(b,h(a))},i.renameFile=function(a,c){function d(){return a.name=c,a.path=f,a}var f=a.path.replace(a.name,c),g=a.persisted?e.rename(a.path,f):b.when(a);return g.then(d,h(a))},i.loadFile=function(a){function b(b){return a.dirty=!1,a.persisted=!0,a.loaded=!0,a.contents=b,a}return e.load(a.path).then(b,h(a))},i.removeFile=function(a){function d(){return a.dirty=!1,a.persisted=!1,Object.freeze(a)}var f;return f=a.persisted?e.remove(a.path):b.when(a),f.then(d,h(a)).then(function(a){c.$broadcast("event:raml-editor-file-removed",a)})},i.createFile=function(b){var e=j+b,f=new a(e);return"raml"===f.extension&&(f.contents=d.getEmptyRaml()),c.$broadcast("event:raml-editor-file-created",f),f},i.saveMeta=function(b,c){var d=new a(b.path+".meta",JSON.stringify(c));return i.saveFile(d).then(function(){return c})},i.loadMeta=function(b){var c=new a(b.path+".meta");return i.loadFile(c).then(function(a){return JSON.parse(a.contents)},function(){return{}})},i}])}(),function(){"use strict";function a(){}a.prototype={directory:function(a){throw"Not implemented: FileSystem list invoked with [fullpath="+a+"]"},save:function(a,b){throw"Not implemented: FileSystem save invoked with [fullpath="+a+"] and [content="+b+"]"},createFolder:function(a){throw"Not implemented: FileSystem createFolder invoked with [fullpath="+a+"]"},load:function(a){throw"Not implemented: FileSystem load invoked with [fullpath="+a+"]"},remove:function(a){throw"Not implemented: FileSystem remove invoked with [fullpath="+a+"]"},rename:function(a,b){throw"Not implemented: FileSystem rename invoked with [source="+a+"] and [destination="+b+"]"}},angular.module("fs").factory("fileSystem",["$injector","config",function(a,b){var c=b.get("fsFactory"),d=c&&a.has(c);return d||b.set("fsFactory",c="localStorageFileSystem"),a.get(c)}])}(),function(){"use strict";function a(a){var b=Math.max.apply(void 0,a.map(function(a){var b=a.name.match(/Untitled-(\d+)\.raml/);return b?b[1]:0}).concat(0));return"Untitled-"+(b+1)+".raml"}angular.module("ramlEditorApp").factory("ramlEditorFilenamePrompt",["$window","$q",function(b,c){var d={open:function(e,f){var g=c.defer();f=f||a(e.files);var h="Choose a name:";0===e.files.length&&(h="The file browser is empty. Please provide a name for the new file:");var i=b.prompt(h,f);if(0===e.files.length&&(i=i||f),i){var j=e.files.some(function(a){return a.name.toLowerCase()===i.toLowerCase()});if(j)return b.alert("That filename is already taken."),d.open(e,f);g.resolve(i)}else g.reject();return g.promise}};return d}])}(),function(){"use strict";angular.module("ramlEditorApp").factory("ramlEditorRemoveFilePrompt",["$window",function(a){return{open:function(b,c){var d=a.confirm('Are you sure you want to delete "'+c.name+'"?');d&&b.removeFile(c)}}}])}(),function(){"use strict";angular.module("fs").constant("LOCAL_PERSISTENCE_KEY","localStorageFilePersistence").constant("FOLDER","folder").factory("localStorageHelper",["LOCAL_PERSISTENCE_KEY",function(a){return{forEach:function(b){var c,d;for(c=0;c<localStorage.length;c++)d=localStorage.key(c),0===d.indexOf(a+".")&&b(JSON.parse(localStorage.getItem(d)))},has:function(a){var b=!1;return a=a||"/",this.forEach(function(c){c.path.toLowerCase()===a.toLowerCase()&&(b=!0)}),b},set:function(b,c){localStorage.setItem(a+"."+b,JSON.stringify(c))},get:function(b){return JSON.parse(localStorage.getItem(a+"."+b))},remove:function(b){localStorage.removeItem(a+"."+b)}}}]).factory("localStorageFileSystem",["$q","$timeout","localStorageHelper","FOLDER",function(a,b,c,d){function e(a){return'file with path="'+a+'" does not exist'}function f(a,b){a.type===d&&(a.children=b(a.path))}function g(a){var b=[];return c.forEach(function(c){c.path.toLowerCase()===a.toLowerCase()&&(f(c,h),b.push(c))}),b.length>0?b[0]:null}function h(a){a.lastIndexOf("/")!==a.length-1&&(a+="/");var b=[];return c.forEach(function(c){c.path.toLowerCase()!==a.toLowerCase()&&0===c.path.indexOf(a+c.name)&&(f(c,h),b.push(c))}),b}function i(a){return 0!==a.indexOf("/")?{valid:!1,reason:'Path should start with "/"'}:{valid:!0}}function j(a){var b=a.slice(0,a.lastIndexOf("/"));return c.has(b)||""===b?!0:!1}function k(a){var b=!1;return c.forEach(function(c){c.path.toLowerCase()!==a.toLowerCase()&&0===c.path.indexOf(a)&&(b=!0)}),b}function l(a){var b=i(a);if(!b.valid)throw"Invalid Path!";return a.lastIndexOf("/")===a.length-1&&(a=a.slice(0,a.length-1)),a.slice(a.lastIndexOf("/")+1)}var m={},n=500;return m.directory=function(d){var e=a.defer();return b(function(){var a=i(d);return a.valid?(c.has("/")||c.set(d,{path:"/",name:"/",type:"folder",meta:{created:Math.round((new Date).getTime()/1e3)}}),void e.resolve(g(d))):(e.reject(a.reason),e.promise)},n),e.promise},m.save=function(e,f){var g=a.defer();return b(function(){var a=l(e),b=c.get(e);if(!j(e))return g.reject("Parent folder does not exists"),g.promise;var h={};if(b){if(b.type===d)return g.reject("file has the same name as a folder"),g.promise;b.content=f,b.meta.lastUpdated=Math.round((new Date).getTime()/1e3),h=b}else h={path:e,name:a,content:f,type:"file",meta:{created:Math.round((new Date).getTime()/1e3)}};c.set(e,h),g.resolve()},n),g.promise},m.createFolder=function(d){var e=a.defer(),f=i(d);if(!f.valid)return e.reject(f.reason),e.promise;if(c.has(d))return e.reject("Folder already exists"),e.promise;var g=d.slice(0,d.lastIndexOf("/"));return c.has(g)?(b(function(){c.set(d,{path:d,name:l(d),type:"folder",meta:{created:Math.round((new Date).getTime()/1e3)}}),e.resolve()},n),e.promise):(e.reject("Parent folder does not exists"),e.promise)},m.load=function(d){var f=a.defer();return b(function(){var a=c.get(d);a&&"file"===a.type?f.resolve(c.get(d).content):f.reject(e(d))},n),f.promise},m.remove=function(e){var f=a.defer();
return b(function(){var a=c.get(e);return a&&a.type===d&&k(e)?(f.reject("folder not empty"),f.promise):(c.remove(e),void f.resolve())},n),f.promise},m.rename=function(e,f){var g=a.defer();return b(function(){var a=c.get(e);if(!a)return g.reject("Source file or folder does not exists."),g.promise;var b=c.get(f);return b?(g.reject("File or folder already exists."),g.promise):j(f)?(a.path=f,a.name=l(f),c.remove(f),c.remove(e),c.set(f,a),a.type===d&&c.forEach(function(a){if(a.path.toLowerCase()!==e.toLowerCase()&&0===a.path.indexOf(e)){var b=f+a.path.substring(e.length);c.remove(a.path),a.path=b,c.set(b,a)}}),void g.resolve()):(g.reject("Destination folder does not exist."),g.promise)},n),g.promise},m}])}(),function(){"use strict";angular.module("ramlEditorApp").service("mockingServiceClient",["$http","$q","$window",function(a,b,c){var d=this;d.proxy=null,d.host="http://mocksvc.mulesoft.com",d.base="/mocks",d.buildURL=function(){var a=d.host+d.base+[""].concat(Array.prototype.slice.call(arguments,0)).join("/"),b=d.proxy||c.RAML.Settings.proxy;return b&&(a=b+a),a},d.simplifyMock=function(a){return{id:a.id,baseUri:a.baseUri,manageKey:a.manageKey}},d.getMock=function(c){return a.get(d.buildURL(c.id,c.manageKey)).then(function(a){return d.simplifyMock(a.data)},function(a){return 404!==a.status?b.reject(a):void 0})},d.createMock=function(b){return a.post(d.buildURL(),b).then(function(a){return d.simplifyMock(a.data)})},d.updateMock=function(b){return a({method:"PATCH",url:d.buildURL(b.id,b.manageKey),data:{raml:b.raml,json:b.json}}).then(function(a){return d.simplifyMock(angular.extend(b,a.data))})},d.deleteMock=function(b){return a.delete(d.buildURL(b.id,b.manageKey))}}])}(),function(){"use strict";angular.module("ramlEditorApp").service("mockingService",["mockingServiceClient","ramlRepository",function(a,b){function c(a){return b.loadMeta(a).then(function(a){return a.mock})}function d(a,c){return b.loadMeta(a).then(function(d){return d.mock=c,b.saveMeta(a,d)}).then(function(){return c})}var e=this;e.getMock=function(a){return c(a)},e.createMock=function(b,c){return a.createMock({raml:b.contents,json:c}).then(function(a){return d(b,a)})},e.updateMock=function(b,e){return c(b).then(function(c){return c&&a.updateMock(angular.extend(c,{raml:b.contents,json:e}))}).then(function(a){return d(b,a)})},e.deleteMock=function(b){return c(b).then(function(b){return b&&a.deleteMock(b)}).then(function(){return d(b,null)})}}])}(),function(){"use strict";angular.module("stringFilters",[]).filter("dasherize",function(){return function(a){return a?a.toLowerCase().trim().replace(/\s/g,"-"):""}})}(),function(){"use strict";angular.module("ramlEditorApp").constant("UPDATE_RESPONSIVENESS_INTERVAL",800).service("ramlParserFileReader",["$http","$q","ramlParser","ramlRepository","safeApplyWrapper",function(a,b,c,d,e){function f(a){return d.loadFile({path:a}).then(function(a){return a.contents})}function g(b){return a.get(b,{transformResponse:null}).then(function(a){return a.data},function(a){var c="cannot fetch "+b+", check that the server is up and that CORS is enabled";throw a.status&&(c+="(HTTP "+a.status+")"),c})}this.readFileAsync=e(null,function(a){var c=/^https?:\/\//.test(a)?g(a):f(a),d=new b.defer;return c.then(d.resolve.bind(d),d.reject.bind(d)),d.promise})}]).controller("ramlEditorMain",["UPDATE_RESPONSIVENESS_INTERVAL","$scope","$rootScope","$timeout","$window","safeApply","safeApplyWrapper","debounce","throttle","ramlHint","ramlParser","ramlParserFileReader","ramlRepository","eventService","codeMirror","codeMirrorErrors","config","$prompt","$confirm","$modal",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(a){var b="";return a&&(b=a.path,a.dirty&&(b="* "+b)),b}function v(a){function b(a){return a.__isFold}function c(a){return a.find().from.line}function d(a,b){return Math.min(a,b)}var e={line:a};return x.findMarksAt(e).filter(b).map(c).reduce(d,y)}function w(a,b,c){return c===b?a:"Error on line "+(b+1)+": "+a}var x,y,z;e.setTheme=function(a){q.set("theme",a),b.theme=c.theme=a,f(b)},b.$on("event:raml-editor-file-selected",function(a,c){o.configureEditor(x,c.extension),z=c,n.broadcast("event:raml-parsed",{}),x.setValue(c.contents),b.fileParsable=b.getIsFileParsable(c)}),b.$on("event:raml-editor-file-removed",function(a,b){z===b&&(z=void 0,x.setValue(""))}),b.sourceUpdated=function(){var a=x.getValue(),c=b.fileBrowser.selectedFile;b.clearErrorMarks(),c.contents=a,b.fileParsable=b.getIsFileParsable(c),n.broadcast("event:raml-source-updated",a)},b.loadRaml=function(a,b){return k.load(a,b,{validate:!0,transform:!0,compose:!0,reader:l})},b.clearErrorMarks=function(){p.clearAnnotations(),b.hasErrors=!1},n.on("event:raml-source-updated",function(a,c){return b.clearErrorMarks(),b.fileParsable&&""!==c.trim()?void b.loadRaml(c,((b.fileBrowser||{}).selectedFile||{}).path).then(g(b,function(a){b.fileBrowser.selectedFile.raml=angular.copy(a),n.broadcast("event:raml-parsed",a)}),g(b,function(a){n.broadcast("event:raml-parser-error",a)})):(b.currentError=void 0,void(y=void 0))}),n.on("event:raml-parsed",g(b,function(a,c){b.title=c.title,b.version=c.version,b.currentError=void 0,y=void 0})),n.on("event:raml-parser-error",g(b,function(a,c){var d=c.problem_mark,e=0,f=0,g=c.message;y=e,b.currentError=c,d&&(y=d.line,e=v(y),f=d.column),p.displayAnnotations([{line:e+1,column:f+1,message:w(g,y,e)}])})),b.openHelp=function(){t.open({templateUrl:"views/help.html"})},b.getIsFileParsable=function(a,c){return"raml"!==a.extension?!1:(c=arguments.length>1?c:a.contents,0!==c.search(/^\s*#%RAML( \d*\.\d*)?\s*(\n|$)/)?!1:((b.fileBrowser||{}).rootFile||a)!==a?!1:!0)},b.getIsMockingServiceVisible=function(){return b.fileParsable?!0:!1},b.getIsShelfVisible=function(){return b.fileParsable?!0:!1},b.getIsConsoleVisible=function(){return b.fileParsable?!0:!1},b.toggleShelf=function(){b.shelf.collapsed=!b.shelf.collapsed,q.set("shelf.collapsed",b.shelf.collapsed)},b.getSelectedFileAbsolutePath=function(){return u(z)},n.on("event:toggle-theme",function(){e.setTheme("dark"===b.theme?"light":"dark")}),function(){b.currentError=void 0,b.theme=c.theme=q.get("theme","dark"),b.shelf={},b.shelf.collapsed=JSON.parse(q.get("shelf.collapsed","false")),b.editor=x=o.initEditor(),x.on("fold",function(a,c,d){c.line<=y&&y<=d.line&&p.displayAnnotations([{line:c.line+1,message:w(b.currentError.message,y,c.line)}])}),x.on("unfold",function(){var a=v(y),c=w(b.currentError.message,y,a);p.displayAnnotations([{line:a+1,message:c}])}),x.on("change",h(function(){b.sourceUpdated()},q.get("updateResponsivenessInterval",a))),e.onbeforeunload=function(){var a=b.homeDirectory.files.some(function(a){return a.dirty});return a?"WARNING: You have unsaved changes. Those will be lost if you leave this page.":void 0}}()}])}(),function(){"use strict";angular.module("ramlEditorApp").factory("applySuggestion",["ramlSnippets","generateTabs","getNode",function(a,b,c){return function(d,e){var f=a.getSnippet(e),g=c(d),h="-"===g.line.trim(),i=g.lineIndent.tabCount,j=h?" ":"",k=h?"":b(i);if(e.isList&&!h){var l=g.selfOrPrevious(function(a){return a.isArrayStarter});!l||g.lineIndent.tabCount===l.lineIndent.tabCount&&g.lineNumber!==l.lineNumber||e.metadata&&e.metadata.isText?j="- ":g.isArrayStarter&&(k=b(i+1))}for(var m=f.map(function(a,b){return k+(0===b?j:"")+a}).join("\n");;){if(g.isEmpty)break;var n=c(d,g.lineNumber+1);if(!n||n.lineIndent.tabCount<=i)break;g=n}var o={line:g.lineNumber,ch:g.line.trimRight().length},p={line:o.line,ch:g.line.length},q=!g.isEmpty&&!h;q&&(m="\n"+m),d.replaceRange(m,o,p),d.setCursor({line:o.line+f.length-(q?0:1)}),d.focus()}}]).value("suggestionKeyToTitleMapping",{"<resource>":"New Resource"}).factory("updateSuggestions",["ramlHint","suggestionKeyToTitleMapping",function(a,b){return function(c){var d=a.getSuggestions(c),e={},f={sections:[]};return d.forEach(function(a){a.title=b[a.key]||a.key,e[a.metadata.category]=e[a.metadata.category]||{name:a.metadata.category,items:[]},e[a.metadata.category].items.push(a),a.isList=d.isList}),Object.keys(e).forEach(function(a){f.sections.push(e[a])}),f.path=d.path,f}}]).controller("ramlEditorShelf",["$scope","safeApplyWrapper","applySuggestion","updateSuggestions",function(a,b,c,d){var e=a.editor;a.cursorMoved=b(null,function(){a.model=d(e)}),a.orderSections=function(a){var b=["root","docs","methods","parameters","responses","security","resources","traits and types"].indexOf(a.name.toLowerCase());return-1===b?b.length:b},a.itemClick=function(a){c(e,a)},e.on("cursorActivity",a.cursorMoved)}])}(),function(){"use strict";angular.module("ramlEditorApp").constant("NOTIFICATION_TIMEOUT",3e3).controller("notifications",["NOTIFICATION_TIMEOUT","eventService","$scope","$timeout",function(a,b,c,d){function e(){var b;f.length&&(b=f.splice(0,1)[0],c.message=b.message,c.expires=b.expires,c.shouldDisplayNotifications=!0,b.expires&&d(function(){c.shouldDisplayNotifications=!1,e()},a))}var f=[];c.shouldDisplayNotifications=!1,b.on("event:notification",function(a,b){f.push(JSON.parse(JSON.stringify(b))),e()}),c.hideNotifications=function(){c.shouldDisplayNotifications=!1,e()}}])}(),function(){"use strict";angular.module("ramlEditorApp").controller("mockingServiceController",["$scope","mockingService","getNode",function(a,b,c){function d(){function b(b,c,d){a.editor.setLine(b,(d||"")+a.editor.getLine(b)+"\n"+c)}for(var d="baseUri: "+a.mock.baseUri,e=c(a.editor,0);e;){if("baseUri"===e.getKey())return void b(e.lineNumber,d,"#");e=e.getNextSibling()}for(var f=0;a.editor.getLine(f);f++)if("---"===a.editor.getLine(f).trim())return void b(f,d);b(0,d)}function e(){var b="baseUri: "+a.mock.baseUri,c=void 0,d=void 0;for(c=0;c<a.editor.lineCount();c++)if(d=a.editor.getLine(c).trim(),d===b){a.editor.removeLine(c);break}for(c=Math.min(c,a.editor.lineCount()-1);c>=0;c--)if(d=a.editor.getLine(c).trim(),0===d.indexOf("#")&&0===d.slice(1).trim().indexOf("baseUri: ")){a.editor.setLine(c,d.slice(1).trim());break}}function f(b){return a.loading=!0,b.finally(function(){a.loading=!1})}function g(b){a.mock=b,a.enabled=!!b}function h(){f(b.getMock(a.fileBrowser.selectedFile).then(g))}function i(){f(b.createMock(a.fileBrowser.selectedFile,a.fileBrowser.selectedFile.raml).then(g).then(d))}function j(){b.updateMock(a.fileBrowser.selectedFile,a.fileBrowser.selectedFile.raml).then(g)}function k(){f(b.deleteMock(a.fileBrowser.selectedFile).then(function(){e()}).then(g))}a.toggleMockingService=function(){return a.fileBrowser.selectedFile?a.enabled?void k():void i():void 0},a.$watch("fileBrowser.selectedFile",function(a){a?h():g()}),a.$watch("fileBrowser.selectedFile.raml",function(){a.enabled&&j()})}])}(),function(){"use strict";angular.module("splitter",[]).directive("ngSplitter",["$window","config",function(a,b){function c(a){return a.attr("ng-splitter-collapse-target")}function d(a){return a[c(a)]()}function e(a){return a[{next:"prev",prev:"next"}[c(a)]]()}function f(a,b){return d(a).css("min-width",Math.max(0,b)+"px"),Math.max(0,b)}function g(a,b,g){var i=d(a),j=h(i,b),k=e(a),l=h(k,b),m={next:1,prev:-1}[c(a)];return 0>l+g*m&&(g=l*m*-1),g&&(j=f(a,j-g*m)),j}function h(a,b){var c="offset"+b[0].toUpperCase()+b.slice(1);return a[0][c]}function i(a,c){return b.get("splitterSize_"+a.attr("id"))||j(a,c)}function j(a,c){var e=h(d(a),c);return b.set("splitterSize_"+a.attr("id"),e),e}function k(a){return"true"===b.get("splitterCollapsed_"+a.attr("id"))}function l(a,c){b.set("splitterCollapsed_"+a.attr("id"),c)}function m(a,b){b=arguments.length>1?b:!k(a),a.toggleClass("collapsed",b),d(a).toggleClass("hide-display",b),l(a,b)}return angular.element.prototype.prev||(angular.element.prototype.prev=function(){var a;if(this.length)for(a=this[0].previousSibling;null!==a&&1!==a.nodeType;)a=a.previousSibling;return angular.isDefined(a)?angular.element(a):this}),{restrict:"A",link:function(b,c,d){var e,h=!1,l=!0,n="vertical"===d.ngSplitter,o=n?"width":"height",p=n?"clientX":"clientY",q=i(c,o),r=k(c),s=c.parent();f(c,q),m(c,r),c.on("mousedown",function(a){0===a.button&&(e=a[p],q=i(c,o),r=k(c),h=!0,s.addClass("noselect"))}),angular.element(a).on("mousemove",function(a){if(h){l=!0;var b=0===g(c,o,a[p]-e);b!==r&&m(c,b),e=a[p],r=b}}).on("mouseup",function(){h&&(r?(m(c,!0),f(c,q)):j(c,o),h=!1,s.removeClass("noselect"))}),c.children(".split").on("mousedown",function(){l=!1}),c.children(".split").on("mouseup",function(){l||(m(c),l=!0,h=!1)})}}}])}(),function(){"use strict";angular.module("ramlEditorApp").directive("ramlEditor",function(){return{restrict:"E",templateUrl:"views/raml-editor-main.tmpl.html",controller:"ramlEditorMain"}})}(),function(){"use strict";angular.module("ramlEditorApp").directive("ramlEditorContextMenu",["$window","ramlRepository","ramlEditorRemoveFilePrompt","ramlEditorFilenamePrompt","scroll",function(a,b,c,d,e){function f(a,e){return[{label:"Save",execute:function(){b.saveFile(e)}},{label:"Delete",execute:function(){c.open(a,e)}},{label:"Rename",execute:function(){d.open(a,e.name).then(function(a){b.renameFile(e,a)})}}]}function g(a){var b=a.getBoundingClientRect();return!(b.top>=0&&b.left>=0&&b.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&b.right<=(window.innerWidth||document.documentElement.clientWidth))}return{restrict:"E",templateUrl:"views/raml-editor-context-menu.tmpl.html",link:function(b,c){function d(a,b){var c=b.getBoundingClientRect(),d=c.left+.5*c.width,e=c.top+.5*c.height,f=angular.element(a[0].children[0]);f.css("left",d+"px"),f.css("top",e+"px"),setTimeout(function(){g(f[0])&&f.css("top",e-f[0].offsetHeight+"px")},0)}function h(){e.enable(),b.$apply(function(){delete j.file,b.opened=!1,a.removeEventListener("click",h),a.removeEventListener("keydown",i)})}function i(a){27===a.which&&(a.preventDefault(),h())}var j={open:function(g,j){e.disable(),this.file=j,b.actions=f(b.homeDirectory,j),g.stopPropagation(),d(c,g.target),a.addEventListener("click",h),a.addEventListener("keydown",i),b.opened=!0}};b.registerContextMenu(j)},scope:!0}}])}(),function(){"use strict";angular.module("ramlEditorApp").directive("ramlEditorFileBrowser",["$rootScope","$q","$window","ramlEditorFilenamePrompt","ramlRepository","config","eventService",function(a,b,c,d,e,f,g){function h(a){function h(b){83!==b.which||!b.metaKey&&!b.ctrlKey||b.shiftKey||b.altKey||(b.preventDefault(),a.$apply(function(){k.saveFile(k.selectedFile)}))}function i(){d.open(a.homeDirectory).then(function(b){a.homeDirectory.createFile(b)})}function j(a){for(var b=[a],c=0;c<b.length;){for(var d=b[c],e=d.files,f=void 0,g=0;g<e.length;g++){if(f=e[g],"file"===f.type&&f.root)return f;"directory"===f.type&&b.push(f)}c+=1}}var k=this,l=angular.noop,m=void 0;k.selectFile=function(c){if(k.selectedFile!==c){f.set("currentFile",JSON.stringify({path:c.path,name:c.name})),l();var d=c.loaded||!c.persisted,g=d?b.when(c):e.loadFile(c);g.then(function(b){k.selectedFile=b,a.$emit("event:raml-editor-file-selected",b),l=a.$watch("fileBrowser.selectedFile.contents",function(a,c){a!==c&&(b.dirty=!0)})})}},k.saveFile=function(a){e.saveFile(a).then(function(){g.broadcast("event:notification",{message:"File saved.",expires:!0})})},k.showContextMenu=function(a,b){m.open(a,b)},k.contextMenuOpenedFor=function(a){return m&&m.file===a},c.addEventListener("keydown",h),a.fileBrowser=k,a.registerContextMenu=function(a){m=a},a.$on("event:raml-editor-file-created",function(a,b){k.selectFile(b)}),a.$on("event:raml-editor-file-removed",function(b,c){c===k.selectedFile&&a.homeDirectory.files.length>0&&k.selectFile(a.homeDirectory.files[0])}),a.$on("$destroy",function(){c.removeEventListener("keydown",h)}),e.getDirectory().then(function(b){if(a.homeDirectory=b,k.rootFile=j(b),a.$watch("homeDirectory.files",function(a){a.length||setTimeout(i,0)},!0),!b.files.length)return void i();var c=JSON.parse(f.get("currentFile","{}")),d=b.files.filter(function(a){return a.path===c.path})[0]||k.rootFile||b.files[0];k.selectFile(d)})}return{restrict:"E",templateUrl:"views/raml-editor-file-browser.tmpl.html",controller:h}}])}(),function(){"use strict";angular.module("ramlEditorApp").directive("ramlEditorSaveFileButton",["$rootScope","ramlRepository",function(a,b){return{restrict:"E",template:'<span role="save-button" ng-click="saveFile()"><i class="fa fa-save"></i>&nbsp;Save</span>',link:function(c){c.saveFile=function(){var d=c.fileBrowser.selectedFile;b.saveFile(d).then(function(){a.$broadcast("event:notification",{message:"File saved.",expires:!0})})}}}}])}(),function(){"use strict";angular.module("ramlEditorApp").directive("ramlEditorNewFileButton",["ramlEditorFilenamePrompt",function(a){return{restrict:"E",template:'<span role="new-button" ng-click="newFile()"><i class="fa fa-plus"></i>&nbsp;New File</span>',link:function(b){b.newFile=function(){var c=b.homeDirectory;a.open(c).then(function(a){c.createFile(a)})}}}}])}(),angular.module("ramlEditorApp").run(["$templateCache",function(a){"use strict";a.put("views/help.html",'<div class="modal-header">\n    <h3><i class="fa fa-question-circle"></i> Help</h3>\n</div>\n\n<div class="modal-body">\n    <p>\n        The API Designer for RAML is built by MuleSoft, and is a web-based editor designed to help you author RAML specifications for your APIs.\n        <br />\n        <br />\n        RAML is a human-and-machine readable modeling language for REST APIs, backed by a workgroup of industry leaders.\n    </p>\n\n    <p>\n        To learn more about the RAML specification and other tools which support RAML, please visit <a href="http://www.raml.org" target="_blank">http://www.raml.org</a>.\n        <br />\n        <br />\n        For specific questions, or to get help from the community, head to the community forum at <a href="http://forums.raml.org" target="_blank">http://forums.raml.org</a>.\n    </p>\n</div>\n'),a.put("views/raml-editor-context-menu.tmpl.html",'<ul role="context-menu" ng-show="opened">\n  <li role="context-menu-item" ng-repeat="action in actions" ng-click="action.execute()">{{ action.label }}</li>\n</ul>\n'),a.put("views/raml-editor-file-browser.tmpl.html",'<raml-editor-context-menu></raml-editor-context-menu>\n<ul class="file-list">\n  <li class="file-item"\n      ng-repeat="file in homeDirectory.files | orderBy:\'name\'"\n      ng-click="fileBrowser.selectFile(file)"\n      ng-class="{currentfile: fileBrowser.selectedFile === file, dirty: file.dirty, geared: fileBrowser.contextMenuOpenedFor(file)}">\n    <span class="file-name">{{file.name}}</span>\n    <i class="fa fa-cog" ng-click="fileBrowser.showContextMenu($event, file)"></i>\n  </li>\n</ul>\n'),a.put("views/raml-editor-main.tmpl.html",'<div role="raml-editor" class="{{theme}}">\n  <div role="notifications" ng-controller="notifications" class="hidden" ng-class="{hidden: !shouldDisplayNotifications}">\n    {{message}}\n    <i class="fa fa-check" ng-click="hideNotifications()"></i>\n  </div>\n\n  <header>\n    <h1>\n      <strong>API</strong> Designer\n    </h1>\n\n    <a role="logo" target="_blank" href="http://mulesoft.com"></a>\n  </header>\n\n  <ul class="menubar">\n    <li class="menu-item menu-item-ll">\n      <raml-editor-new-file-button></raml-editor-new-file-button>\n    </li>\n    <li class="menu-item menu-item-ll">\n      <raml-editor-save-file-button></raml-editor-save-file-button>\n    </li>\n    <li class="spacer file-absolute-path">{{getSelectedFileAbsolutePath()}}</li>\n    <li class="menu-item menu-item-fr menu-item-mocking-service" ng-show="getIsMockingServiceVisible()" ng-controller="mockingServiceController" ng-click="toggleMockingService()">\n      <div class="title"><span class="beta">BETA</span>Mocking Service</div>\n      <div class="field-wrapper" ng-class="{loading: loading}">\n        <span ng-if="loading"><i class="fa fa-spin fa-spinner"></i></span>\n        <div class="field" ng-if="!loading">\n          <input type="checkbox" value="None" id="mockingServiceEnabled" ng-checked="enabled" ng-click="$event.preventDefault()" />\n          <label for="mockingServiceEnabled"></label>\n        </div>\n      </div>\n    </li>\n    <li class="menu-item menu-item-fr" ng-click="openHelp()">\n      <i class="help fa fa-question-circle"></i>\n      <span>&nbsp;Help</span>\n    </li>\n  </ul>\n\n  <div role="flexColumns">\n    <raml-editor-file-browser role="browser"></raml-editor-file-browser>\n\n    <div id="browserAndEditor" ng-splitter="vertical" ng-splitter-collapse-target="prev"><div class="split split-left">&nbsp;</div></div>\n\n    <div role="editor" ng-class="{error: currentError}">\n      <div id="code" role="code"></div>\n\n      <div role="shelf" ng-show="getIsShelfVisible()" ng-class="{expanded: !shelf.collapsed}">\n        <div role="shelf-tab" ng-click="toggleShelf()">\n          <i class="fa fa-inbox fa-lg"></i><i class="fa" ng-class="shelf.collapsed ? \'fa-caret-up\' : \'fa-caret-down\'"></i>\n        </div>\n\n        <div role="shelf-container" ng-show="!shelf.collapsed" ng-include src="\'views/raml-editor-shelf.tmpl.html\'"></div>\n      </div>\n    </div>\n\n    <div id="consoleAndEditor" ng-show="getIsConsoleVisible()" ng-splitter="vertical" ng-splitter-collapse-target="next"><div class="split split-right">&nbsp;</div></div>\n\n    <div ng-show="getIsConsoleVisible()" role="preview-wrapper">\n      <raml-console with-root-documentation></raml-console>\n    </div>\n  </div>\n</div>\n'),a.put("views/raml-editor-shelf.tmpl.html",'<ul role="sections" ng-controller="ramlEditorShelf">\n  <li role="section" ng-repeat="section in model.sections | orderBy:orderSections" class="{{section.name | dasherize}}">\n    {{section.name}}&nbsp;({{section.items.length}})\n    <ul role="items">\n      <li ng-repeat="item in section.items" ng-click="itemClick(item)"><i class="fa fa-reply"></i><span>{{item.title}}</span></li>\n    </ul>\n  </li>\n</ul>\n')}]);